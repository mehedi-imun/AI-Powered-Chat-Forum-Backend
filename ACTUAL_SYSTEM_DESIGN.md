# Actual Backend System Design - Simple Monolithic Architecture

## ğŸ¯ Your Backend Architecture (No Load Balancer, Monolithic)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Browser    â”‚  â”‚  Mobile App  â”‚  â”‚  Postman/API â”‚              â”‚
â”‚  â”‚   (React/    â”‚  â”‚   (React     â”‚  â”‚   Clients    â”‚              â”‚
â”‚  â”‚   Next.js)   â”‚  â”‚   Native)    â”‚  â”‚              â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                            â”‚                                         â”‚
â”‚                   HTTP/WebSocket Requests                            â”‚
â”‚                   (Port 5000 or 3000)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SINGLE EXPRESS.JS SERVER                            â”‚
â”‚                     (Monolithic App)                                â”‚
â”‚                        Port: 5000                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Security & Middleware Layer                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Helmet  â”‚  â”‚   CORS   â”‚  â”‚Rate Limit â”‚  â”‚Pino Logger  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚(Security)â”‚  â”‚(Frontend)â”‚  â”‚(20 req/   â”‚  â”‚(JSON Logs)  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚          â”‚  â”‚          â”‚  â”‚15min Auth)â”‚  â”‚             â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Authentication & Validation Middleware            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  authenticate    â”‚  â”‚    authorize     â”‚  â”‚ validateReq â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  (JWT Verify)    â”‚  â”‚  (RBAC: User/    â”‚  â”‚ (Zod Schema)â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  Access Token    â”‚  â”‚  Moderator/Admin)â”‚  â”‚ Validation  â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   API Routes (/api/v1/*)                       â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  /auth        /users        /threads       /posts             â”‚  â”‚
â”‚  â”‚  /notifications  /admin     /webhook                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Business Logic Modules (7 modules)                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚   Auth   â”‚  â”‚  Users   â”‚  â”‚ Threads  â”‚  â”‚  Posts   â”‚      â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Login  â”‚  â”‚ â€¢ Profileâ”‚  â”‚ â€¢ Create â”‚  â”‚ â€¢ Create â”‚      â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Signup â”‚  â”‚ â€¢ Update â”‚  â”‚ â€¢ Search â”‚  â”‚ â€¢ Reply  â”‚      â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Reset  â”‚  â”‚ â€¢ Delete â”‚  â”‚ â€¢ Summaryâ”‚  â”‚ â€¢ Vote   â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚  â”‚
â”‚  â”‚  â”‚  Admin   â”‚  â”‚Notificat.â”‚  â”‚ Webhook  â”‚                    â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Stats  â”‚  â”‚ â€¢ Create â”‚  â”‚ â€¢ Receiveâ”‚                    â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Ban    â”‚  â”‚ â€¢ Read   â”‚  â”‚ â€¢ Log    â”‚                    â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Reportsâ”‚  â”‚ â€¢ Delete â”‚  â”‚          â”‚                    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  Each Module has:                                             â”‚  â”‚
â”‚  â”‚  â€¢ *.routes.ts â†’ HTTP endpoints                               â”‚  â”‚
â”‚  â”‚  â€¢ *.controller.ts â†’ Request handlers                         â”‚  â”‚
â”‚  â”‚  â€¢ *.service.ts â†’ Business logic                              â”‚  â”‚
â”‚  â”‚  â€¢ *.validation.ts â†’ Zod schemas                              â”‚  â”‚
â”‚  â”‚  â€¢ *.model.ts â†’ Mongoose models                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Service Layer                               â”‚  â”‚
â”‚  â”‚  â€¢ email.service.ts â†’ SMTP email sending                      â”‚  â”‚
â”‚  â”‚  â€¢ ai.service.ts â†’ OpenAI GPT-4 calls                         â”‚  â”‚
â”‚  â”‚  â€¢ queue.service.ts â†’ RabbitMQ publish                        â”‚  â”‚
â”‚  â”‚  â€¢ cron.service.ts â†’ Scheduled jobs (6 jobs)                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              INFRASTRUCTURE & DATA LAYER                            â”‚
â”‚              (Separate Containers/Services)                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   REDIS CACHE    â”‚   â”‚    RABBITMQ      â”‚   â”‚  SOCKET.IO   â”‚  â”‚
â”‚  â”‚   Port: 6379     â”‚   â”‚   Port: 5672     â”‚   â”‚  (Built-in)  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ User sessions  â”‚   â”‚ 4 Queues:        â”‚   â”‚ â€¢ Events:    â”‚  â”‚
â”‚  â”‚ â€¢ Thread lists   â”‚   â”‚ 1. ai_moderation â”‚   â”‚ join-thread  â”‚  â”‚
â”‚  â”‚ â€¢ User data      â”‚   â”‚ 2. ai_summary    â”‚   â”‚ new-post     â”‚  â”‚
â”‚  â”‚ â€¢ Cache keys     â”‚   â”‚ 3. notifications â”‚   â”‚ notification â”‚  â”‚
â”‚  â”‚   (TTL: 5 min)   â”‚   â”‚ 4. webhooks      â”‚   â”‚ post-updated â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              MONGODB DATABASE (Port 27017)                   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  6 Collections:                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  users   â”‚ â”‚ threads  â”‚ â”‚  posts   â”‚ â”‚notifications â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚   â”‚
â”‚  â”‚  â”‚ reports  â”‚ â”‚ webhook  â”‚                                 â”‚   â”‚
â”‚  â”‚  â”‚          â”‚ â”‚   logs   â”‚                                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Features:                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Indexes on frequently queried fields                    â”‚   â”‚
â”‚  â”‚  â€¢ TTL indexes for auto-cleanup                            â”‚   â”‚
â”‚  â”‚  â€¢ Text search indexes                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            BACKGROUND WORKER PROCESSES (4 Workers)                  â”‚
â”‚          (Same Node.js Process, Separate Threads)                   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ ai-moderation    â”‚   â”‚  ai-summary      â”‚                      â”‚
â”‚  â”‚    .worker.ts    â”‚   â”‚    .worker.ts    â”‚                      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
â”‚  â”‚ â€¢ Consume queue  â”‚   â”‚ â€¢ Consume queue  â”‚                      â”‚
â”‚  â”‚ â€¢ Check posts    â”‚   â”‚ â€¢ Generate       â”‚                      â”‚
â”‚  â”‚   with GPT-4     â”‚   â”‚   thread summary â”‚                      â”‚
â”‚  â”‚ â€¢ Flag content   â”‚   â”‚   with GPT-4     â”‚                      â”‚
â”‚  â”‚ â€¢ Retry 3 times  â”‚   â”‚ â€¢ Save summary   â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚  notification    â”‚   â”‚    webhook       â”‚                      â”‚
â”‚  â”‚    .worker.ts    â”‚   â”‚    .worker.ts    â”‚                      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
â”‚  â”‚ â€¢ Consume queue  â”‚   â”‚ â€¢ Consume queue  â”‚                      â”‚
â”‚  â”‚ â€¢ Send email via â”‚   â”‚ â€¢ Process webhookâ”‚                      â”‚
â”‚  â”‚   SMTP/Nodemailerâ”‚   â”‚   events         â”‚                      â”‚
â”‚  â”‚ â€¢ Socket.IO push â”‚   â”‚ â€¢ Log to DB      â”‚                      â”‚
â”‚  â”‚ â€¢ Retry 3 times  â”‚   â”‚ â€¢ Retry 3 times  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                     â”‚
â”‚  All workers start with server in server.ts                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CRON JOBS (6 Scheduled Tasks)                     â”‚
â”‚                 Initialized in cron.service.ts                      â”‚
â”‚                                                                     â”‚
â”‚  1. Cleanup Old Notifications (Daily 2 AM)                          â”‚
â”‚  2. Send Digest Emails (Daily 8 AM)                                â”‚
â”‚  3. Update User Activity (Every hour)                               â”‚
â”‚  4. Generate Stats (Every 6 hours)                                  â”‚
â”‚  5. Health Check (Every 5 minutes)                                  â”‚
â”‚  6. Unban Expired Users (Every hour)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL SERVICES                                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   OPENAI API     â”‚   â”‚   SMTP SERVER    â”‚   â”‚   WEBHOOK    â”‚  â”‚
â”‚  â”‚    (GPT-4)       â”‚   â”‚   (Nodemailer)   â”‚   â”‚  PROVIDERS   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ Content        â”‚   â”‚ â€¢ Gmail/Custom   â”‚   â”‚ â€¢ SendGrid   â”‚  â”‚
â”‚  â”‚   moderation     â”‚   â”‚ â€¢ Port 587       â”‚   â”‚ â€¢ Mailgun    â”‚  â”‚
â”‚  â”‚ â€¢ Thread summary â”‚   â”‚ â€¢ Verification   â”‚   â”‚ â€¢ Others     â”‚  â”‚
â”‚  â”‚ â€¢ AI features    â”‚   â”‚ â€¢ Password reset â”‚   â”‚ (Optional)   â”‚  â”‚
â”‚  â”‚                  â”‚   â”‚ â€¢ Digest emails  â”‚   â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Examples

### 1. User Registration Flow:

```
Client
  â”‚
  â”‚ 1. POST /api/v1/auth/register
  â”‚    {name, email, password}
  â–¼
Express Server (Port 5000)
  â”‚
  â”‚ 2. Rate Limit Check
  â”‚ 3. Zod Validation
  â–¼
Auth Controller â†’ Auth Service
  â”‚
  â”‚ 4. Hash password (bcrypt)
  â”‚ 5. Create user document
  â–¼
MongoDB (users collection)
  â”‚
  â””â”€â”€â†’ User saved
       â”‚
       â”œâ”€â”€â†’ 6. Publish to RabbitMQ
       â”‚    (notification queue)
       â”‚
       â”œâ”€â”€â†’ 7. Generate JWT tokens
       â”‚    (access + refresh)
       â”‚
       â””â”€â”€â†’ Return tokens to client
            â”‚
            â–¼
       Notification Worker
            â”‚
            â”‚ 8. Consume queue message
            â”‚ 9. Send verification email
            â–¼
       SMTP Server
       Email sent âœ“
```

### 2. Post Creation with AI Moderation:

```
Client (Authenticated)
  â”‚
  â”‚ 1. POST /api/v1/posts
  â”‚    Authorization: Bearer <token>
  â”‚    {threadId, content}
  â–¼
Express Server
  â”‚
  â”‚ 2. Authenticate JWT
  â”‚ 3. Validate input
  â–¼
Post Controller â†’ Post Service
  â”‚
  â”œâ”€â”€â†’ 4. Save to MongoDB
  â”‚    (posts collection)
  â”‚    Status: active
  â”‚
  â”œâ”€â”€â†’ 5. Publish to RabbitMQ
  â”‚    (ai_moderation queue)
  â”‚
  â””â”€â”€â†’ 6. Socket.IO emit
       (real-time update)
       â”‚
       â–¼
  Connected Clients
  Receive "new-post" event
       â”‚
       â–¼
  AI Moderation Worker
       â”‚
       â”‚ 7. Consume from queue
       â”‚ 8. Call OpenAI API
       â”‚    (GPT-4 content check)
       â–¼
  OpenAI Response
       â”‚
       â”œâ”€â”€â†’ If Clean: Mark as checked
       â”‚
       â””â”€â”€â†’ If Flagged:
            â€¢ Update post status
            â€¢ Notify moderators
            â€¢ Log incident
```

### 3. Real-Time Thread Updates:

```
Client A creates post
  â”‚
  â””â”€â”€â†’ Post Service
       â”‚
       â”œâ”€â”€â†’ Save to MongoDB
       â”‚
       â””â”€â”€â†’ Socket.IO Server
            â”‚
            â”‚ emit "new-post" event
            â”‚ to room "thread-{threadId}"
            â–¼
       Connected Clients
       (Client B, C, D in same thread)
            â”‚
            â””â”€â”€â†’ Receive update instantly
                 â€¢ Update UI
                 â€¢ Show new post
                 â€¢ No page refresh needed
```

### 4. Caching with Redis:

```
Client requests thread list
  â”‚
  â”‚ GET /api/v1/threads?page=1
  â–¼
Express Server
  â”‚
  â””â”€â”€â†’ Thread Controller
       â”‚
       â”‚ 1. Check Redis cache
       â”‚    Key: "thread:list:1:20"
       â”‚
       â”œâ”€â”€â†’ Cache HIT?
       â”‚    â”‚
       â”‚    â”œâ”€â”€â†’ YES: Return cached data
       â”‚    â”‚    (Fast response <10ms)
       â”‚    â”‚
       â”‚    â””â”€â”€â†’ NO: Query MongoDB
       â”‚         â”‚
       â”‚         â”œâ”€â”€â†’ Fetch threads
       â”‚         â”‚
       â”‚         â”œâ”€â”€â†’ Store in Redis
       â”‚         â”‚    (TTL: 5 minutes)
       â”‚         â”‚
       â”‚         â””â”€â”€â†’ Return data to client
```

---

## ğŸ” Security Flow (Multi-Layer):

```
Client Request
    â”‚
    â”‚ Layer 1: Network
    â–¼
HTTPS/TLS (if configured)
    â”‚
    â”‚ Layer 2: API Gateway
    â–¼
Helmet Headers + CORS
    â”‚
    â”‚ Layer 3: Rate Limiting
    â–¼
Auth routes: 20 req/15min
Other routes: Standard limit
    â”‚
    â”‚ Layer 4: Authentication
    â–¼
JWT Token Verification
â€¢ Check signature
â€¢ Check expiry
â€¢ Extract user info
    â”‚
    â”‚ Layer 5: Authorization
    â–¼
Role-Based Access Control
â€¢ User â†’ Basic operations
â€¢ Moderator â†’ + Moderation
â€¢ Admin â†’ Full access
    â”‚
    â”‚ Layer 6: Input Validation
    â–¼
Zod Schema Validation
â€¢ Type checking
â€¢ Length validation
â€¢ Format validation
    â”‚
    â”‚ Layer 7: Data Security
    â–¼
â€¢ Password hashing (bcrypt)
â€¢ Sanitization
â€¢ XSS prevention
    â”‚
    â–¼
Business Logic Execution
```

---

## ğŸ—ï¸ Technology Stack Summary:

| Component      | Technology              | Port       | Purpose            |
| -------------- | ----------------------- | ---------- | ------------------ |
| **API Server** | Express.js + TypeScript | 5000       | Main application   |
| **Database**   | MongoDB (Mongoose)      | 27017      | Data persistence   |
| **Cache**      | Redis (IORedis)         | 6379       | Performance        |
| **Queue**      | RabbitMQ                | 5672       | Async jobs         |
| **Real-Time**  | Socket.IO               | (built-in) | WebSocket          |
| **AI**         | OpenAI GPT-4            | API        | Moderation/Summary |
| **Email**      | Nodemailer (SMTP)       | 587        | Email sending      |
| **Logger**     | Pino                    | -          | JSON logging       |
| **Monitoring** | Prometheus + Grafana    | 3001       | Metrics            |

---

## ğŸ“¦ Deployment Architecture:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Docker Compose Setup                     â”‚
â”‚  (docker-compose.dev.yml or docker-compose.yml)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚MongoDB â”‚    â”‚  Redis   â”‚    â”‚ RabbitMQ â”‚
   â”‚Container    â”‚Container â”‚    â”‚Container â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚               â”‚               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Backend Containerâ”‚
              â”‚ (Node.js)        â”‚
              â”‚ â€¢ Express Server â”‚
              â”‚ â€¢ 4 Workers      â”‚
              â”‚ â€¢ 6 Cron Jobs    â”‚
              â”‚ â€¢ Socket.IO      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Port 5000
                        â–¼
                    [Clients]
```

---

## âš¡ Key Features:

### Monolithic Benefits:

âœ… Simple deployment (single container)
âœ… Easy debugging (everything in one place)
âœ… No network latency between services
âœ… Shared memory and resources
âœ… Simple transaction management
âœ… Lower operational complexity

### Scaling Strategy (When needed):

ğŸ“ˆ Horizontal Scaling:
â€¢ Add Nginx load balancer
â€¢ Run multiple Express instances
â€¢ Use Redis for session sharing
â€¢ Socket.IO with Redis adapter

ğŸ“Š Vertical Scaling:
â€¢ Increase container resources
â€¢ Optimize database queries
â€¢ Add more Redis memory
â€¢ Tune RabbitMQ settings

---

**This is your ACTUAL backend architecture - simple, monolithic, efficient!** ğŸš€

No load balancer, single Express.js server handling everything, with external services (MongoDB, Redis, RabbitMQ) as separate containers.
